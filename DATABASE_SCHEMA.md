# Схема базы данных

## Таблицы

### Аутентификация и авторизация
- **user_group** - Группы пользователей
- **content_type** - Типы контента для системы разрешений
- **permission** - Разрешения доступа
- **group_permissions** - Связь групп и разрешений
- **user** - Пользователи системы
- **user_groups** - Связь пользователей и групп
- **user_permissions** - Связь пользователей и разрешений

### Справочники
- **currency** - Валюты

### Финансовые данные
- **category** - Категории транзакций (доходы/расходы)
- **account** - Финансовые счета
- **transaction** - Транзакции
- **recurring_transaction** - Повторяющиеся транзакции
- **budget** - Бюджеты
- **budget_category_limit** - Лимиты расходов по категориям в бюджетах

### История изменений
- **account_history** - История изменений счетов
- **budget_history** - История изменений бюджетов

## Представления

- **v_monthly_income_expense_report** - Отчет по доходам и расходам по месяцам
- **v_category_report** - Отчет по категориям за период
- **v_account_balance_report** - Отчет по счетам с балансами и статистикой
- **v_budget_execution_report** - Отчет по исполнению бюджета

## Процедуры

- **sp_create_transaction_with_balance_update** - Создание транзакции с автоматическим обновлением баланса счета
- **sp_close_budget** - Закрытие бюджета

## Функции

- **fn_get_account_balance_on_date** - Расчет баланса счета на определенную дату
- **fn_check_budget_limits** - Проверка лимитов бюджета по категориям

## Триггеры

- **trg_account_history_insert_update** - Логирование создания и обновления счетов
- **trg_account_history_delete** - Логирование удаления счетов
- **trg_budget_history_insert_update** - Логирование создания и обновления бюджетов
- **trg_budget_history_delete** - Логирование удаления бюджетов

## Роли

- **admin_role** - Полный доступ ко всем объектам
- **operator_role** - Доступ к финансовым данным (без изменения пользователей)
- **client_role** - Только чтение всех данных



